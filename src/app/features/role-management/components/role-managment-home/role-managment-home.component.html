<div>
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4>Role</h4>
      <p>Manage user roles and permissions</p>
    </div>
  </div>

  <div>
    <table
      mat-table
      [dataSource]="permissions"
      class="custom-table mat-elevation-z8">
      <!-- Permission Name Column -->
      <ng-container matColumnDef="permission">
        <th mat-header-cell *matHeaderCellDef>Permission</th>
        <td mat-cell *matCellDef="let perm">{{ perm.name }}</td>
      </ng-container>

      <!-- Dynamically create role columns -->
      <ng-container *ngFor="let role of roles" [matColumnDef]="role.value">
        <th mat-header-cell *matHeaderCellDef>{{ role.label }}</th>
        <td mat-cell *matCellDef="let perm">
          <mat-checkbox
            [(ngModel)]="checkboxModel[perm.permission_id][role.value]"
            (change)="
              onCheckboxChange(perm.permission_id, role.value, $event.checked)
            ">
          </mat-checkbox>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <button mat-raised-button color="primary" (click)="saveChanges()">
      Save Changes
    </button>
  </div>
</div>
